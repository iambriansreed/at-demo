<div
  class="mention-container"
  (focusout)="onBlur($event)"
  (keydown)="onKeyDown($event)"
  (input)="onInput($event)"
>
  <ng-content></ng-content>
  <input
    type="text"
    name="mentions"
    [value]="mentions.join(',')"
    style="display: none"
  />
  <div class="dropdown" [style]="dropdownStyle">
    <ul *ngIf="suggestions; else loading" data-mention-dropdown>
      @for (suggestion of suggestions; track suggestion.id; let i = $index) {
      <li [class.selected]="selectedSuggestion === i">
        <button type="button" (click)="onSuggestionSelect(i)">
          <span class="avatar" *ngIf="suggestion.type === 'user'">
            <img
              *ngIf="suggestion.avatar; else placeholderAvatar"
              [src]="suggestion.avatar"
              [alt]="suggestion.label"
            />
            <ng-template #placeholderAvatar>
              <svg role="img" viewBox="0 0 448 512">
                <path
                  fill="currentColor"
                  d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"
                ></path>
              </svg>
            </ng-template>
          </span>
          <span class="label" [innerHTML]="suggestion.label"></span>
        </button>
      </li>
      }
      <li *ngIf="suggestions.length === 0" class="none-found">
        <span class="name">Nothing found</span>
      </li>
    </ul>
    <ng-template #loading>
      <div class="loader"></div>
    </ng-template>
  </div>
</div>
